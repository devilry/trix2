{% extends "django_cradmin/base.django.html" %}
{% load i18n %}l
{% load trix_admin_tags %}

{% block content %}
    <div class="page-header">
        <div class="container-fluid">
            <span class="fa fa-bar-chart-o"></span>
            <h1>
                {% trans "Trix" %}:
                <strong>{% trans "Statistics" %}</strong>
            </h1>
        </div>
    </div>
    
    <div class="page-sub-header">    
        <div class="container">
            <h1>{% trans "Aggregated statistics on how the assignments where solved" %}</h1>
            <p>{% trans "The stats below show how many percentage of the total number of users that have completed the assignment by their own, with help or not completed it." %}</p>
            <div class="stat-info">
                <ul>
                    <li>{% trans "Number of users:" %} {{ user_count }}</li>
                    <li>{% trans "Number of assignments:" %} {{ assignment_count }}</li>
                    <li><a href="{% url 'trix_stats_ascsv' %}?tag={{ tag_id }}" class="btn btn-primary btn-sm" role="button">{% trans "Download csv file" %}</a></li>
                </ul>
            </div>
        </div>
    </div>

    <div class="container">
        <table class="table">
            
        {% for assignment in assignment_list %}

                    <div class="row">
                        <div class="assignment-info col-md-4">
                            <h2>{{ assignment }}</h2>
                            <p class="hidden-xs">{{ assignment.text|truncatechars:90 }}</p>
                        </div>
                    

                        <div class="progress-info col-md-8">
                               
                        {% with assignment|compute_stats:'bymyself' as bymyself_percent %}
                            <p class="progress-element">
                                {% trans "Completed by their own" %} {{ bymyself_percent }} %
                                {% include "trix_admin/include/progress_bar.django.html" with percent=bymyself_percent style='success' %}
                            </p>
                        {% endwith %}

                        {% with assignment|compute_stats:'withhelp' as withhelp_percent %}
                            <p class="progress-element"> 
                                {% trans "Completed with help" %} {{ withhelp_percent }} %
                                {% include "trix_admin/include/progress_bar.django.html" with percent=withhelp_percent style='warning'%}                              
                            </p>
                        {% endwith %}

                        {% with assignment|compute_stats:'notsolved' as notsolved_percent %}
                            <p class="progress-element">
                                {% trans "Not completed" %} {{ notsolved_percent }} %
                                {% include "trix_admin/include/progress_bar.django.html" with percent=notsolved_percent style='info'%}                         
                            </p>
                        {% endwith %}

                        
                        </div>
                    </div>

            {% empty %}
            <p class="empty-assignment-list-info">{% trans "There was no assignments matching the choosen tag" %}</p>
        {% endfor %}
        </table>
            
    {% include "trix_student/include/pager.django.html" %}
    </div>

    {% comment %}
        
    <div class="container">
        <div class="alert alert-success">
            <h4>{% trans "Solved by their own" %} {{ bymyself_percent }}%</h4>
            <div class="progress">
              <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="{{ bymyself_percent }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ bymyself_percent }}%">
              </div>
            </div>
        </div>
        <div class="alert alert-warning">
            <h4>{% trans "Solved with help" %} {{ withhelp_percent }}%</h4>
            <div class="progress">
              <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="{{ withhelp_percent }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ withhelp_percent }}%">
              </div>
            </div>
        </div>
        <div class="alert alert-info">
            <h4>{% trans "Not solved" %} {{ notsolved_percent }}%</h4>
            <div class="progress">
              <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="{{ notsolved_percent }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ notsolved_percent }}%">
              </div>
            </div>
        </div>
    </div>
    {% endcomment %}



{% endblock content %}